<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>-</title>
<style>
* {
margin: 0;
padding: 0;
}
body {
padding: 20px;
}
.app {
width: 400px;
max-width: 100%;
margin: 0 auto;
}
#title {
background-color: #f2f2f2;
height: 40px;
line-height: 40px;
font-size: 18px;
text-align: center;
}
#table {
width: 100%;
border-collapse: collapse;
}
tr {
height: 40px;
}
tr:nth-child(even) {
background-color: #f2f2f2;
}
tr:not(:last-child) {
border-bottom: 1px solid rgba(221, 221, 221, 0.5);
}
th + th {
border-left: 1px solid rgba(221, 221, 221, 0.5);
}
th {
font-size: 16px;
font-weight: normal;
color: #333;
/* 删除文本左对齐 */
}
tr th:first-of-type {
font-weight: bold;
}
.phone-link {
color: blue;
text-decoration: underline;
cursor: pointer;
}
</style>
</head>
<body>
<div class="app">
<h1 id="title"></h1>
<table id="table"></table>
</div>

<script>
  const main = async () => {
    const $ = document.querySelector.bind(document);
    /**
     * @type {HTMLElement}
     */
    const $title = $('#title');
    /**
     * @type {HTMLElement}
     */
    const $table = $('#table');

    const query = new URLSearchParams(location.search.split('?')[1]);
    const path = `data/${query.get('id')}.txt`;

    const [[title], ...data] = await fetch(path)
      .then((res) => res.text())
      .catch(() => '')
      .then((str) =>
        str
          .split(/^$/gm)
          .map((it) => it.trim())
          .map((it) =>
            it
              .split(/\n|\r/)
              .map((subit) => subit.trim())
              .filter(Boolean),
          ),
      );

    document.title = title;
    $title.innerHTML = title;

    const formatCell = (cellContent) => {
      if (/^\d{4}-\d{7}$/.test(cellContent)) {
        return `<a class="phone-link" href="tel:${cellContent}">${cellContent}</a>`;
      } else if (/^\d{11}$/.test(cellContent)) {
        return `<a class="phone-link" href="tel:${cellContent}">${cellContent}</a>`;
      } else {
        return cellContent;
      }
    };

    $table.innerHTML =
      '<tbody>' +
      data
        .map((rows) =>
          Array.from({ length: maxCount })
            .map((_, i) => `<th>${formatCell(rows[i] || '')}</th>`)
            .join(''),
        )
        .map((rowStr) => `<tr>${rowStr}</tr>`)
        .join('') +
      '</tbody>';

    const phoneLinks = document.querySelectorAll('.phone-link');
    phoneLinks.forEach((link) => {
      link.addEventListener('click', (event) => {
        event.preventDefault();
        const phoneNumber = event.target.getAttribute('href').replace('tel:', '');
        window.location.href = `tel:${phoneNumber}`;
      });
    });
  };

  main();
</script>
</body>
</html>