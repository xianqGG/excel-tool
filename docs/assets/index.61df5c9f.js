import{r as e,R as t,I as r,W as n,w as a,x as o,a as c}from"./vendor.a279a142.js";const l=/\-|至/,s=/（单号）/,i=/（双号）/,u=/（(\d+)个）/,p=/^\d+$/,f=/、|，/,d=/(\d+\-\d+)号/;function m(e){return p.test(e)}function h(e=""){const t=[s,i].findIndex((t=>{const r=t.test(e);return e=e.replace(t,""),r}))+1;let r=0;try{r=+e.match(u)[1],e=e.replace(u,"")}catch(g){r=0}if(r)return Array(r).fill(e);if(d.test(e))return[e];if(!l.test(e))return[e];const[n,a]=e.split(l);if(m(n)&&m(a)&&+n>=+a)return[e];const o=new RegExp(a.replace(/\d+/,"(\\d+)")),[c,p]=[o.exec(n),o.exec(a)];if(!c||!p)return console.log("解析错误：",{start:n,end:a,val:e,matchReg:o}),[];const[f,h]=[+c[1],+p[1]],v=[];for(let l=f;l<=h;l++)t&&l%2!=t%2||v.push(n.replace(o,((e,t)=>e.replace(t,l+""))));return v}function v(e,t){const r=/(\d+)号/;return d.test(t)?[e,t]=[e+t.replace(d,""),d.exec(t)[1]]:r.test(t)&&([e,t]=[e+t.replace(r,""),r.exec(t)[1]]),[e=e.replace(/(\d+)组/,((e,t)=>e.replace(t,function(e){var t=["零","一","二","三","四","五","六","七","八","九"],r=["","万","亿","万亿","亿亿"],n=["","十","百","千"];function a(e){for(var r="",a="",o=0,c=!0;e>0;){var l=e%10;0===l?c||(c=!0,a=t[l]+a):(c=!1,r=t[l],a=(r+=n[o])+a),o++,e=Math.floor(e/10)}return a}var o=0,c="",l="",s=!1;if(0===e)return t[0];for(;e>0;){var i=e%1e4;s&&(l=t[0]+l),c=a(i),l=(c+=0!==i?r[o]:r[0])+l,s=i<1e3&&i>0,e=Math.floor(e/1e4),o++}return l.replace(/^一十/,"十")}(+t)))),t]}function g(e){return function(e){if("string"!=typeof e||!e)return[];e=e.trim();const[t,r]=e.split("：");return r?r.split(f).reduce(((e,t)=>[...e,...h(t)]),[]).map((e=>[t,e])):(console.log(`格式不匹配跳过：【${e}】`),[])}(e).map((([e,t])=>v(e,t)))}function x(){const[c,l]=e.exports.useState("复兴路：2-1、5；复兴村：19号、25号；新乐街：1号-165号（单号）；新乐街：2号-230号（双号）；沫江社区：33幢1号-16号、34幢1号-13号（单号）、35幢2号-8号（双号）；永丰村：1组1号、2组69号、3组1号-19号；太平社区：1-1（44个）、1-2（30个）；永丰村1组1号-41号，2组1号-69号，3组1号-42号，4组1号-38号，5组1号-53号，6组1号-70号；喻坝村1组1号至7号，2组1号至47号，3组1号至81号，4组1号至53号，5组1号至94号，6组1号至111号；临江路南段2号、4号、42号、福禄大街北段28号、30号、向阳路南段1号-65号、福兴街34号附1号-附130号、福禄大街南段27号附1号-附100号、新政街25号附1号-附100号、福兴街33号附1号-附40号；幸福路7号、幸福路62号、幸福路72号、兴贸街56号、明珠街1号、明珠街3号、明珠街34号、明珠街36号；龙泉街：1号、3号、4号、6号、7号、8号、10号、12号、14号-45号、47号、49号-87号（单号）；");return t.createElement("div",{className:"App"},t.createElement(r,{multiline:!0,minRows:5,value:c,width:"100%",onChange:e=>l(e.target.value)}),t.createElement("div",null,t.createElement(n,{autoLoading:!0,onClick:async()=>{await a.time(100);const e=c.trim().split("；").reduce(((e,t)=>(e.push(...g(t).map((e=>[...e]))),e)),[["名称","号码"]]),t=o.utils.json_to_sheet(e),r=o.utils.book_new();o.utils.book_append_sheet(r,t),o.writeFile(r,"out.xlsb"),console.log(e)}},"生成 excel")))}c.render(t.createElement(t.StrictMode,null,t.createElement(x,null)),document.getElementById("root"));
